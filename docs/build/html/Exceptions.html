

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exceptions &mdash; BootIntegrityValidator 0.3 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="BootIntegrityValidator 0.3 documentation" href="index.html"/>
        <link rel="prev" title="Validation" href="Validation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> BootIntegrityValidator
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Initialization.html">Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Validation.html">Validation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exceptions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">BootIntegrityValidator</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Exceptions</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Exceptions.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="exceptions">
<span id="id1"></span><h1>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">Â¶</a></h1>
<blockquote>
<div>If validation fails a custom exception will be raised for the following reasons:</div></blockquote>
<ul class="simple">
<li><strong>BootIntegrityValidator.BootIntegrityValidator.ValidationException</strong><ul>
<li>When calling validate() if the hashes do not match any of the valid hashes within the KGV file.  This is an indication of compromise of the device.</li>
<li>When initializing the object if validation of the signature file fails or the validation of the custom signing cert fails</li>
</ul>
</li>
<li><strong>BootIntegrityValidator.BootIntegrityValidator.VersionNotFound</strong><ul>
<li>When calling validate() if the version of software used by the device is not within the KGV file.  It is not possible to determine whether or not the device is compromised.  Contact Cisco to obtain the latest KGV file.</li>
</ul>
</li>
<li><strong>BootIntegrityValidator.BootIntegrityValidator.ProductNotFound</strong><ul>
<li>The product (the model number) was unable to be mapped to the &#8216;product&#8217; in the KGV.  For example ISR4321/K9 should be mapped to &#8220;ISR4K&#8221;.  The ProductFamily Object within BootIntegrityValidator/platforms.py may need to be updated.</li>
<li>The &#8216;product&#8217; is not found within the KGV file. It is not possible to determine whether or not the device is compromised.  Contact Cisco to obtain the latest KGV file.</li>
</ul>
</li>
<li><strong>BootIntegrityValidator.BootIntegrityValidator.InvalidFormat</strong><ul>
<li>If the KGV file is not formatted correctly.  Obtain a latest copy of the KGV file and a signature file to validate the file hasn&#8217;t been modified.</li>
</ul>
</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># An instance of BootIntegrityValidator has already been initialized as &#39;biv&#39;</span>
<span class="c1"># with the known good values (KGV).</span>

<span class="n">show_plat_suid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example_show_plat_sudi.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">suid</span> <span class="o">=</span> <span class="n">show_plat_suid</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">show_plat_int</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example_show_plat_int.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">spi</span> <span class="o">=</span> <span class="n">show_plat_int</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">biv</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">show_platform_integrity_cmd_output</span><span class="o">=</span><span class="n">spi</span><span class="p">,</span>
                 <span class="n">show_platform_sudi_certificate_cmd_output</span><span class="o">=</span><span class="n">suid</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Successfully validated!&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">InvalidFormat</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;know_good_values had an invalid format&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">VersionNotFound</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Version of software Not Found in known_good_values&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">ProductNotFound</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Product in cli output not mapped to &#39;product&#39; in known_good_values&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">BootIntegrityValidator</span><span class="o">.</span><span class="n">ValidationException</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Validation failed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Validation.html" class="btn btn-neutral" title="Validation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Jay Young.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>