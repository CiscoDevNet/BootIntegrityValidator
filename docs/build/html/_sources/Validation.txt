.. _Validation:

Validation
==========

Validation of the Cisco device can be performed using the following commands:

- show platform sudi certficate sign nonce <0-18446744073709551615>
- show platform integrity sign nonce <0-18446744073709551615>


Example CLI output for *show platform sudi certificate sign nonce 42*

.. code-block:: text

    isr4321#show platform sudi certificate sign nonce 42
    -----BEGIN CERTIFICATE-----
    MIIDQzCCAiugAwIBAgIQX/h7KCtU3I1CoxW1aMmt/zANBgkqhkiG9w0BAQUFADA1
    ...
    <output omitted for brevity>
    ...
    kxpUnwVwwEpxYB5DC2Ae/qPOgRnhCzU=
    -----END CERTIFICATE-----
    -----BEGIN CERTIFICATE-----
    MIIEPDCCAySgAwIBAgIKYQlufQAAAAAADDANBgkqhkiG9w0BAQUFADA1MRYwFAYD
    ...
    <output omitted for brevity>
    ...
    0IFJZBGrooCRBjOSwFv8cpWCbmWdPaCQT2nwIjTfY8c=
    -----END CERTIFICATE-----
    -----BEGIN CERTIFICATE-----
    MIIDejCCAmKgAwIBAgIDMEqgMA0GCSqGSIb3DQEBCwUAMCcxDjAMBgNVBAoTBUNp
    <output omitted for brevity>
    IAFBbdvdOwLEVVBc76g74H7zJDkv9VtVtOZk0Ft5
    -----END CERTIFICATE-----

    Signature version: 1
    Signature:
    626B8BA48EDEE3F23124D3D3D36CF4FE4E1CB81DB5086E13CFC1172FC4A71B1ECA62423574A8DEA4EBE2C6364367930D1A2F6A136D60A010F9684710CCDC4A288F48A2ACA9ED0940E58F65C7459B248D8FF5E1D01B1270F261C97A7FA618782462CD44C8BC0F0889FA504A2C1A338F610DB81654253F0A1A2FA6F3D1E641A9D868C4D0BF59C0AE755D9A9325A03CC4B9DEE230DD8AAA9410C8FF668C59E12B9EFE70EB71A3EC8E459AB4C7DD2C9754228A3D1FF660416B9D3FC06B88958EA4EED83E7E62AD89D15513F69D5A09DB9AD50B3C3E4C8DA75EEA009FDA1A635B373E5C8F0923F1D0B40189BF7DD0A6CDD4ED7BC3AAB975613EC1B4D24069C4FA502C
    isr4321#


Example CLI output for *show platform integrity sign nonce 43*

.. code-block:: text

    isr4321#show platform integrity sign nonce 43
    Platform: ISR4321/K9
    Boot 0 Version: F01023R12.1817bb4af2014-05-23
    Boot 0 Hash: B29EE97FA16911AE4058434EA7EC4464BD1341A57B17FB84550B2DDE2ABFDFD7
    Boot Loader Version: 16.4(2r)
    Boot Loader Hash: 6B261787C44E9F462ACB5ABA3550A2DE3EFC7767FB8F9285CFAE2A49F8291A91A70C0E6C0E1774751EF2C56B8031B6288700081E42F22908FC05559D45D914AF
    OS Version: 16.04.01
    OS Hash: 219ADB02A47F753AB76E8B386CAC6E135FEC4AF43F9D68CCE1C1D7746D5CDE6C47302583860EE309D6DB94CE595F3383BCF7F85E5251C4F52D8D8F7F8837EADB
    PCR0: 8A023CD8EB2CA11B130D39F9ED739C6687804755C6910E3A0758F2A2C8F97969
    PCR8: 69B21FA7658F2EB8ADF4E1E19CBB079C8A96D3288154D80542F44BBEC4C275D0
    Signature version: 1
    Signature:
    9ADC6105582516A791264E6C1BF1ED5941C7DE3BB761E94113FEB6206B50C5053F80261D1B839097071033B7F4BCA2C47CDF40E27A9E16D5CA959593ED943D3F8F2AEA7755F8AF999D4E5D1784A23A08DBD66EFFDCF63B41E31B11C03AE899AFA3C3CDF28CDDC5D79E1E3AF19E2C5DD497204A111C7407D8950643A48686EC38540A74A9A8CF9BE9C7FF61ECDAB01A3BCC426596B8F5257772AD99FC6E8BE0BE542BB99D0C6529F34C02EFF5388DDC1351977351E823B535B7512A1C121AD9C6AFD289872A7EF0B52F7EE0F615FEFACB6931536227F934843DBC2F4D5B604E2F03CE4B6D9B292CC64BCFA423C78B25FF8F2986C9A54D694FD8C4C569CFBB3DD4

    isr4321#


To validate the output call the validate() function providing the output as strings.  The function will perform validation
and return nothing if successfully validated.  If validation fails a custom exception will be raised.  See the next chapter for
more details about the exceptions.

.. code-block:: python

    # An instance of BootIntegrityValidator has already been initialized as 'biv'
    # with the known good values (KGV).

    show_plat_suid = open("example_show_plat_sudi.txt", "r")
    suid = show_plat_suid.read()

    show_plat_int = open("example_show_plat_int.txt", "r")
    spi = show_plat_int.read()


    biv.validate(show_platform_integrity_cmd_output=spi,
                     show_platform_sudi_certificate_cmd_output=suid)
    print("Successfully validated!")

